jQuery((function(t){class e{constructor(t){this.data=t||{},this.data.outOfStockAttributes=this.findOutOfStockAttributes(),this.data.state=this.data.state||{},this.data.$originPrice=this.data.$price.clone()}getState(t){return t?this.data.state[t]:Object.assign({},this.data.state)}render(){const e=this.getState();if(!e)return;const a=this.data.$variations.find("li"),i=Object.keys(e).filter((function(t){return!!t})).map((function(a){return"a."+t.escapeSelector(a+"_"+e[a])})).join(",");a.removeClass("active"),a.find(i).each((function(){t(this).parent().addClass("active")})),this.handleOutOfStockVisibility(this.findMatchingOutOfStockVariations());const n=this.findMatchingVariation();n?(this.data.$addToCartButton.attr("data-product_id",n.variation_id),this.data.$addToCartButton.removeClass("variation-btn-disabled"),n.price_html&&this.updateProductPriceData(t(n.price_html))):(this.data.$addToCartButton.attr("data-product_id",""),this.data.$addToCartButton.addClass("variation-btn-disabled"),this.updateProductPriceData(this.data.$originPrice.clone()))}updateState(t){this.data.state=Object.assign({},this.data.state,t),this.render()}findMatchingVariation(){const t=this.data.variations,e=this.getState();for(var a=[],i=0;i<t.length;i++){var n=t[i];this.isExactMatch(n.attributes,e)&&a.push(n)}return a.shift()}updateProductPriceData(t){this.data.$price.replaceWith(t),this.data.$price=t}getVariationImage(e){const a=this.findFirstMatchingVariationOfGivenState(e);if(!a)return;const i=a.image;return t(`\n                    <img\n                        class="replaced-img preload-me aspect lazy lazy-load"\n                        style="--ratio: ${i.src_w} / ${i.src_h};"\n                        width="${i.src_w}"\n                        height="${i.src_h}"\n                        data-src="${i.src}"\n                        data-srcset="${i.srcset||""}"\n                        alt="${i.alt||""}"\n                        title="${i.title||""}"\n                        data-caption="${i.data_caption||""}"\n                        loading="eager"\n                        data-large_image="${i.full_src}"\n                        data-large_image_width="${i.full_src_w}"\n                        data-large_image_height="${i.full_src_h}"\n                        sizes="${i.sizes}"\n                    />\n                `)}handleOutOfStockVisibility(e){const a=e||this.data.outOfStockAttributes,i=this.data.$variations.find("li a");i.removeClass("out-of-stock");for(const[e,n]of Object.entries(a))if(n.length){const a=n.slice().map((a=>"."+t.escapeSelector(e+"_"+a))).join(",");i.filter(a).addClass("out-of-stock")}}findMatchingOutOfStockVariations(){const t=this,e=this.data.variations,a=this.getState();let i=[];for(var n=0;n<e.length;n++){const t=e[n];!t.is_in_stock&&this.isMatch(t.attributes,a)&&i.push(t)}let o=Object.assign({},this.data.outOfStockAttributes);return i.forEach((function(e){for(const[a,i]of Object.entries(e.attributes))t.getState(a)!==i&&(o[a]=o[a]?.slice()||[],-1===o[a].indexOf(i)&&o[a].push(i))})),o}findOutOfStockAttributes(){const t=this.data.variations;let e=[],a=[],i={};for(let i=0;i<t.length;i++){let n=t[i];n.is_in_stock?e.push(Object.entries(n.attributes)):a.push(Object.entries(n.attributes))}e=[].concat(...e),a=[].concat(...a);const n=function(t,e){const a=e[0],i=e[1];return t[a]=t[a]||[],t[a].push(i),t},o=e.reduce(n,{}),s=a.reduce(n,{});for(const[t,e]of Object.entries(s)){const a=void 0===o[t];(a||o[t])&&(i[t]=e.filter((function(e){return a||!o[t].includes(e)})))}return i}findFirstMatchingVariationOfGivenState(t){if(!t||0===Object.keys(t).length)return;const e=this.data.variations;for(let a=0;a<e.length;a++){let i=e[a];if(this.isExactMatch(t,i.attributes))return i}}isMatch(t,e){var a=!1;for(var i in t)if(t.hasOwnProperty(i)){var n=t[i],o=e[i];void 0!==n&&void 0!==o&&0!==n.length&&0!==o.length&&n===o&&(a=!0)}return a}isExactMatch(t,e){var a=!0;for(var i in t)if(t.hasOwnProperty(i)){var n=t[i],o=e[i];(void 0===n||void 0===o||0===o.length||0!==n.length&&n!==o)&&(a=!1)}return a}}t.productsVariations=function(a){const i=t(a),n=new The7ElementorSettings(i);let o,s,r,c,d={};t.data(a,"productsVariations",i),d={init:function(){const a=i.find(".quantity");if(a.length){const e=i.find(".box-button"),n=t(".qty",a);n.on("change",(function(){e.attr("data-quantity",parseInt(n.val()))}))}const o=i.find("[data-product_variations]");if(o.length){o.each((function(){const a=t(this),o=a.find(".products-variations"),s=a.find(".box-button");let r;r="the7-woocommerce-loop-add-to-cart.default"===i.data("widget_type")?a.closest('div[data-elementor-type="loop-item"]').find(".price").first():a.find("span.price").first();const c=new e({variations:a.data("product_variations"),$addToCartButton:s,$variations:o,$price:r,state:a.data("default_attributes")||{}});o.find("li a").data("the7_product_variations_obj",c),s.attr("data-product_id",""),s.on("click",(function(e){const a=t(this);if("n"==n.getCurrentDeviceSetting("show_variations"))return e.preventDefault(),void window.location.assign(a.attr("href"));a.is(".add_to_cart_button.variation-btn-disabled")&&e.preventDefault()})),c.render()}));const a=i.find(".products-variations li a");if(t(".touchevents").length){let e,i;a.on("touchstart",(function(t){e=t.originalEvent.touches[0].pageY,i=t.originalEvent.touches[0].pageX})),a.on("touchend",(function(a){a.preventDefault();let n=a.originalEvent.changedTouches[0].pageX,o=a.originalEvent.changedTouches[0].pageY;if(e===o||i===n){const e=t(this);d.selectAttribute(e)}}))}else a.on("click",(function(e){e.preventDefault();const a=t(this);d.selectAttribute(a)}))}if(!!t("html.mobile-true").length){const e=i.find(".trigger-img-hover");e.each((function(){const a=t(this);let o,s;if(a.hasClass("woo-ready"))return;const r=!!a.closest(".product-type-variable",i).length;a.on("touchstart",(function(t){o=t.originalEvent.touches[0].pageY,s=t.originalEvent.touches[0].pageX})),a.on("touchend",(function(a){const i=t(this),c=a.originalEvent.changedTouches[0].pageX,l=a.originalEvent.changedTouches[0].pageY,u=!i.hasClass("is-clicked");let h=u;if(u){let u;if(i.hasClass("woo-buttons-on-img"))u=!0;else{const t=i.find(".woo-buttons-on-img").get(0);u=a.originalEvent&&t&&a.originalEvent.composedPath().includes(t)}if(u&&t(a.target).closest(".products-variations-wrap, .woo-list-buttons",i).length){const t=n.getCurrentDeviceSetting("show_variations_on_hover"),e=n.getCurrentDeviceSetting("show_btn_on_hover");(!r||t&&"on-hover"!==t)&&(e&&"on-hover"!==e)&&(h=!1)}if(o==l||s==c){e.removeClass("is-clicked"),i.addClass("is-clicked");const t={boundaryElement:i.get(0),$affectedElements:e};elementorFrontend.elements.$body.off("touchstart",d.onOuterTouchHandler).on("touchstart",t,d.onOuterTouchHandler)}}h&&a.preventDefault()})),a.addClass("woo-ready")}))}},getProductSlider:function(){if(void 0===o&&void 0!==c){const t=c.find(".elementor-widget-the7-slider-common");o=t.length?t.data("productSlider").getSwiper():null}return o},replaceImage:function(e,a){s||(s=e.first().clone()),c.addClass("replace-is-loading"),r=t(),e.each((function(){t(this).replaceWith((function(){const t=a.clone();return t.on("load",(function(){c.removeClass("replace-is-loading")})),r=r.add(t),t}))})),c.addClass("has-replaced-img"),c.layzrInitialisation()},restoreImage:function(){r&&r.length&&s&&s.length&&(d.replaceImage(r,s),r=void 0,c.removeClass("has-replaced-img"))},updateProductImage:function(e){if(!e||!e.length)return void d.restoreImage();const a=d.getProductSlider();if(a){const i=t(a.wrapperEl).find('img[src="'+e.attr("data-src")+'"]').first();if(i.length)d.restoreImage(),a.slideTo(a.slides.indexOf(i.closest(".the7-swiper-slide")[0]));else{a.slideTo(1);const i=1===a.slides.length?t(a.slides[0]).find("img"):t(a.$wrapperEl).find('.the7-swiper-slide[data-swiper-slide-index="0"]').find("img");d.replaceImage(i,e)}}else{const t=c.find("img").first();t[0].src!==e.attr("data-src")&&d.replaceImage(t,e)}},selectAttribute:function(t){const e=t.data("the7_product_variations_obj"),a={[t.closest("ul").attr("data-atr")]:t.parent().hasClass("active")?"":String(t.data("id"))},o=Object.entries(Object.assign({},e.getState(),a)).reduce(((t,[e,a])=>(a&&(t[e]=a),t)),{});c=i.hasClass("elementor-widget-the7-woocommerce-loop-add-to-cart")?t.closest(".product"):t.closest(".woocom-project"),d.updateProductImage(e.getVariationImage(o)),t.is(".out-of-stock")||"n"===n.getCurrentDeviceSetting("show_add_to_cart")||e.updateState(a)},onOuterTouchHandler:function(t){t.originalEvent&&t.data&&t.data.boundaryElement&&!t.originalEvent.composedPath().includes(t.data.boundaryElement)&&t.data.$affectedElements&&t.data.$affectedElements.removeClass("is-clicked")&&elementorFrontend.elements.$body.off("touchstart",d.onOuterTouchHandler)}},d.init()},t.fn.productsVariations=function(){return this.each((function(){void 0!==t(this).data("productsVariations")&&t(this).removeData("productsVariations"),new t.productsVariations(this)}))}})),jQuery(window).on("elementor/frontend/init",(function(){const t=function(t,e){e((function(){t.productsVariations()}))};elementorFrontend.hooks.addAction("frontend/element_ready/the7-wc-products.default",t),elementorFrontend.hooks.addAction("frontend/element_ready/the7-wc-products-carousel.default",t),elementorFrontend.hooks.addAction("frontend/element_ready/the7-woocommerce-loop-add-to-cart.default",t)}));